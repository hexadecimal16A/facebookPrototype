<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<title>Insert title here</title>
<style>
.inputstyle {
	outline: none;
	text-align: center;
}

.navbarstyle {
	display: block;
	width: 100%;
	color: white;
	height: 4em;
	border-radius: 0px;
	background-color: #444444;
	border-color: white;
	border-width: 0em;
}

.navbarstyle2 {
	background-color: #1F83E5;
	border: 0px;
}

button.ex1:hover, button.ex1:active {
	background-color: black;
	color: white;
}

li.ex1:hover, li.ex1:active {
	background-color: #145ea8;
}

.activepage2 {
	background-color: white;
}

.activepage {
	background-color: #2484e5;
}

.panel {
	overflow: auto;
}

.inputstyle {
	background-color: white;
	color: black;
	border: none;
	outline: none;
	text-align: left;
}

.padding-0 {
	padding-right: 0;
	padding-left: 0;
}

img {
	object-fit: cover;
}

.crop {
	width: 100%;
	height: 20em;
}

.edit {
	font-size: 0.9em;
}
</style>
</head>

<body style="background-color: #F0F4F9">
	<nav class="navbar navbarstyle2 navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<img class="img-responsive2" src="icon.png"
					style="height: 50px; width: auto;"> <a class="navbar-brand"
					href="#" style="color: black; font-weight: 500px;">Closer</a>
			</div>
			<ul class="nav navbar-nav">

			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li class="ex1"><a
					href="/facebook/home.html"
					style="color: white;"><span class="glyphicon glyphicon-home"></span>
						Home</a></li>
				<li class="activepage2"><a
					href="/facebook/profile.html"
					style="color: blue;"><span class="glyphicon glyphicon-user"></span>
						Profile</a></li>
				<li class="ex1"><a href="/facebook"
					style="color: white;"><span class="glyphicon glyphicon-log-out"></span>
						Logout</a></li>
			</ul>
		</div>
	</nav>
	<div class="container-fluid" style="margin-top: 3em;">
		<div class="row">
			<div class="col-md-3 padding-0" style="position: relative;">
				<img src="" id="profilePhotoImg" class="img-responsive crop">
				<button
					style="position: absolute; bottom: 0; left: 0; background-color: grey; border: none;"
					type="button" class="btn btn-info" data-toggle="modal"
					data-target="#myModal2">
					<span class="glyphicon glyphicon-camera"></span>
				</button>

			</div>
			<div class="col-md-9 padding-0">
				<img src="a.jpg" class="img-responsive crop">
			</div>
		</div>
	</div>
	<div class="container-fluid">
		<div class="row">
			<nav class="col-md-2 padding-0">
				<ul class="nav nav-pills nav-stacked" data-spy="affix"
					data-offset-top="205">
					<li><button onclick="window.location.href = 'profile.html';" class="btn ex1 navbarstyle"
							id="Timeline"><span class="glyphicon glyphicon-user"></span> Timeline
						</button></li>
					<li><button onclick="showAbout()" class="btn ex1 navbarstyle activepage"
							id="About">
							<span class="glyphicon glyphicon-user"></span> About
						</button></li>
					<li><button onclick="window.location.href = 'profilePhotos.html';" class="btn ex1 navbarstyle">
							<span class="glyphicon glyphicon-camera"></span> Photos
						</button></li>
					<li><button onclick="showFriends()"
							class="btn ex1 navbarstyle">
							<span class="glyphicon glyphicon-glass"></span> Friends
						</button></li>
				</ul>
			</nav>
			<div class="col-md-8 padding-0">
				<div id="section1" class="panel col-md-12" style="display: none;">
					<div class="panel-heading" style="text-align: right;">
						<a href="#" id="blur" class="btn btn-warning edit"
							data-toggle="modal" data-target="#myModal"><span
							class="glyphicon glyphicon-edit"></span>Edit</a>
					</div>
					<form class="form-horizontal">
						<div class="form-group">
							<div class="col-md-3">
								<h5>Name</h5>
							</div>
							<div class="col-md-9 ">
								<input type="text" class="form-control inputstyle" id="Name"
									value="" readonly style="background-color: white;">
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>Email</h5>
							</div>
							<div class="col-md-9">
								<input type="email" class="form-control inputstyle" id="Email"
									value="" readonly style="background-color: white;">
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>Birthday</h5>
							</div>
							<div class="col-md-9">
								<input type="date" class="form-control inputstyle" id="DOB"
									value="" readonly style="background-color: white;">
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>City</h5>
							</div>
							<div class="col-md-9">
								<input type="text" class="form-control inputstyle" id="Hometown"
									value="" readonly style="background-color: white;">
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>Mobile</h5>
							</div>
							<div class="col-md-9">
								<input type="text" class="form-control inputstyle" id="Mobile"
									value="" readonly style="background-color: white;">
							</div>
						</div>
						<div class="form-group" style="display: none;" id="countryDiv">
							<div class="col-md-3">
								<h5>Country</h5>
							</div>
							<div class="col-md-9">
								<input type="text" name="country"
									class="form-control inputstyle" id="Country" name="Country"
									value="" style="background-color: white;" readonly>
							</div>
						</div>
					</form>
				</div>
			</div>
			<div class="col-md-2 padding-0">
				<div class="panel">
					<div class="panel-body">Chats</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal -->
	<div id="myModal" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Edit Personel Information</h4>
				</div>
				<div class="modal-body">
					<form class="form-horizontal" id="modalForm">
						<div class="form-group">
							<div class="col-md-3">
								<h5>Name</h5>
							</div>
							<div class="col-md-9 ">
								<input type="text" class="form-control inputstyle" id="Name2"
									name="name" value="" style="background-color: white;" required>
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>Birthday</h5>
							</div>
							<div class="col-md-9">
								<input type="date" class="form-control inputstyle" id="DOB2"
									name="dOB" value="" style="background-color: white;" required>
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>City</h5>
							</div>
							<div class="col-md-9">
								<input type="text" class="form-control inputstyle"
									id="Hometown2" name="hometown" value=""
									style="background-color: white;" required>
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>Mobile</h5>
							</div>
							<div class="col-md-9">
								<input type="text" class="form-control inputstyle" id="Mobile2"
									name="mobile" value="" style="background-color: white;"
									required>
							</div>
						</div>
						<div class="form-group">
							<div class="col-md-3">
								<h5>Country</h5>
							</div>
							<div class="col-md-9">
								<input type="text" name="country"
									class="form-control inputstyle" id="Country2" name="Country"
									value="" style="background-color: white;">
							</div>
						</div>
						<div class="form-group">
							<input id="submitButton" type="submit" class="btn" value=""
								style="display: none;">
						</div>

					</form>
				</div>
				<div class="modal-footer">
					<p id="modalInfoButton">Editing...</p>
					<button id="modalSave" type="button" class="btn btn-primary"
						onclick="document.getElementById('submitButton').click()">Save</button>
					<button type="button" id="modalClose" class="btn btn-danger"
						data-dismiss="modal" onclick="modalUpdateButtons()">Close</button>
				</div>
			</div>
		</div>
		<!-- Modal end -->
	</div>
	<div id="myModal2" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Upload Photo</h4>
				</div>
                
				<div class="modal-body">
                <div class="container-fluid row" style="display:inline;">
                    <div class="col-md-8">
					<form id="myModal2Form"
						action="/facebook/webapi/file/upload"
						method="post" enctype="multipart/form-data">
						<p id="uploadImage">
							Select a file : <input type="file" name="file" size="45" class="btn btn-success"/>
						</p>
						<input type="text" name="Id" id="profilePhotoId" value=""
							style="display:none;"> <input type="submit"
							value="Upload It" class="btn btn-warning" />

					</form>
                    </div>
				    <div class="col-md-4">
				        <img src="a.jpg" id="modalProfileImg" style="width:100%;height:10em;" onError="doSomething();" />
				    </div>
				</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
				</div>
			</div>

		</div>
	</div>
</body>
</html>

<script>
	/*function load_home() {
	 document.getElementById("section1").innerHTML='<object type="text/html" data="home.html" style="width:100%; height: 100%;" ></object>';
	}*/
	var about = document.getElementById("section1");
	//var friends=document.getElementById("section2");
	//var photos=document.getElementById("section3");
	var modalData;
	var profileImgTemp="a.jpg";
	about.style.display = 'block';
	document.getElementById("About").className = "btn ex1 navbarstyle activepage";
	function showAbout() {
		about.style.display = 'block';
		friends.style.display = 'none';
		photos.style.display = 'none';
	}
	function modalUpdateButtons() {
		document.getElementById('modalInfoButton').innerHTML = 'Editing...';
		document.getElementById('modalSave').disabled = false;
	}
	window.onload = function() {
		//when the document is finished loading, replace everything
		//between the <a ...> </a> tags with the value of splitText
		document.getElementById("profilePhotoId").value = sessionStorage.id;
		//document.getElementById("profilePhotoImg").src="users/"+sessionStorage.id+"/profile.jpg";
	}
	function doSomething() {
	    document.getElementById('modalProfileImg').src=profileImgTemp;
	    console.log("aa");
	} 
	//-----------------------------------------------------------------//
	$('#myModal')
			.on(
					'shown.bs.modal',
					function(e) {
						document.getElementById("Name2").value = modalData.name;
						document.getElementById("Mobile2").value = modalData.mobile;
						document.getElementById("Hometown2").value = modalData.hometown;
						document.getElementById("DOB2").value = modalData.DOB;
						document.getElementById("Country2").value = modalData.country ? modalData.country
								: "";
					})
	//------------------------------------------------------------//
	$('#myModal2')
			.on(
					'shown.bs.modal',
					function(e) {
						document.getElementById("profilePhotoId").value = sessionStorage.id;
					})
	//------------------------------------------------------------//
	$.ajax({
		type : "post",
		// make sure you respect the same origin policy with this url:
		// http://en.wikipedia.org/wiki/Same_origin_policy
		//dataType: "text",
		url : "/facebook/webapi/profile/"
				+ sessionStorage.id,

		success : function(msg) {
			console.log(msg);
			document.getElementById("Name").value = msg.name;
			document.getElementById("Mobile").value = msg.mobile;
			document.getElementById("Email").value = msg.email;
			document.getElementById("Hometown").value = msg.hometown;
			document.getElementById("DOB").value = msg.DOB;
			document.getElementById("profilePhotoImg").src = msg.profileImage;
			if (msg.country) {
				document.getElementById("Country").value = msg.country;
				document.getElementById("countryDiv").style.display = "block";
			}
			modalData = msg;
		}
	});
	//-----------------------------------------------------------------//
	$(".btn").mouseup(function() {
		$(this).blur();
	})
	//-----------------------------------------------------------//
	var modalform = $('#modalForm');
	modalform
			.submit(function() {
				$	
						.ajax({
							type : "put",
							url : "/facebook/webapi/profile/"
									+ sessionStorage.id,
							data : modalform.serialize(),
							success : function(data) {
								if (data == "true") {
									console.log("YES");
									document.getElementById("modalInfoButton").innerHTML = "Saved (Refresh this page to see changes)";
									document.getElementById("modalSave").disabled = true;
								} else {
									document.getElementById("modalInfoButton").innerHTML = "Try Again";
								}
							}
						});

				return false;
			});
	//-----------------------------------/
	var modalform2 = $('#myModal2Form');
	modalform2.submit(function() {
		var fd = new FormData($('#myModal2Form')[0]);
	    console.info(fd);
		$.ajax({
			type : modalform2.attr('method'),
			url : modalform2.attr('action'),
			data : fd,
			enctype: 'multipart/form-data',
	        processData: false,  // Important!
	        contentType: false,
	        cache: false,
			success : function(data) {
				if(data){
					profileImgTemp=data;
					document.getElementById('modalProfileImg').src=profileImgTemp;
					//setTimeout(location.reload.bind(location),8000);
				}
				else{
					alert("Try Again");
				}
			}
		});

		return false;
	});
</script>