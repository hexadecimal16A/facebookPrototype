<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<title>Insert title here</title>
<style>
.inputstyle {
	outline: none;
	text-align: center;
}

.navbarstyle {
	display: block;
	width: 100%;
	color: white;
	height: 4em;
	border-radius: 0px;
	background-color: #444444;
	border-color: white;
	border-width: 0em;
}

.navbarstyle2 {
	background-color: #1F83E5;
	border: 0px;
}

button.ex1:hover, button.ex1:active {
	background-color: black;
	color: white;
}

li.ex1:hover, li.ex1:active {
	background-color: #145ea8;
}

.activepage2 {
	background-color: white;
}

.activepage {
	background-color: #2484e5;
}

.panel {
	overflow: auto;
}

.inputstyle {
	background-color: white;
	color: black;
	border: none;
	outline: none;
	text-align: left;
}

.padding-0 {
	padding-right: 0;
	padding-left: 0;
}

img {
	object-fit: cover;
}

.crop {
	width: 100%;
	height: 20em;
}

.edit {
	font-size: 0.9em;
}
</style>
</head>

<body style="background-color: #F0F4F9">
	<nav class="navbar navbarstyle2 navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<img class="img-responsive2" src="icon.png"
					style="height: 50px; width: auto;"> <a class="navbar-brand"
					href="#" style="color: black; font-weight: 500px;">Closer</a>
			</div>
			<ul class="nav navbar-nav">

			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li class="ex1"><a
					href="/facebook/home.html"
					style="color: white;"><span class="glyphicon glyphicon-home"></span>
						Home</a></li>
				<li class="activepage2"><a
					href="/facebook/profile.html"
					style="color: blue;"><span class="glyphicon glyphicon-user"></span>
						Profile</a></li>
				<li class="ex1"><a href="/facebook"
					style="color: white;"><span class="glyphicon glyphicon-log-out"></span>
						Logout</a></li>
			</ul>
		</div>
	</nav>
	
	<div class="container-fluid" style="margin-top: 3em;">
		<div class="row">
			<div class="col-md-3 padding-0" style="position: relative;">
				<img src="" id="profilePhotoImg" class="img-responsive crop">
				<button
					style="position: absolute; bottom: 0; left: 0; background-color: grey; border: none;"
					type="button" class="btn btn-info" data-toggle="modal"
					data-target="#myModal2">
					<span class="glyphicon glyphicon-camera"></span>
				</button>

			</div>
			<div class="col-md-9 padding-0">
				<img src="a.jpg" class="img-responsive crop">
			</div>
		</div>
	</div>
	
	
<!--  Edit from here  Edit from here Edit from here Edit from here Edit from here Edit from here-->
	
	<div class="container-fluid">
		<div class="row">
			<nav class="col-md-2 padding-0">
				<ul class="nav nav-pills nav-stacked" data-spy="affix"
					data-offset-top="205">
					<li><button onclick="showTimeline()" class="btn ex1 navbarstyle activepage"
							id="Timeline"><span class="glyphicon glyphicon-user"></span> Timeline
						</button></li>
					<li><button onclick="window.location.href = 'profileAbout.html';" class="btn ex1 navbarstyle"
							id="About">
							<span class="glyphicon glyphicon-user"></span> About
						</button></li>
					<li><button onclick=""window.location.href = 'profilePhotos.html';" class="btn ex1 navbarstyle">
							<span class="glyphicon glyphicon-camera"></span> Photos
						</button></li>
					<li><button onclick="showFriends()"
							class="btn ex1 navbarstyle">
							<span class="glyphicon glyphicon-glass"></span> Friends
						</button></li>
				</ul>
			</nav>
			<div class="col-md-8 padding-0">
				<div id="section1" class="panel col-md-12" style="display: none;">
			</div>
			<div class="col-md-2 padding-0">
				<div class="panel">
					<div class="panel-body">Chats</div>
				</div>
			</div>
		</div>
	</div>
<!-- ------------------------------------------------------------------------------------ -->
	<!-- Modal -->
	<div id="myModal2" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Upload Photo</h4>
				</div>
                
				<div class="modal-body">
                <div class="container-fluid row" style="display:inline;">
                    <div class="col-md-8">
					<form id="myModal2Form"
						action="/facebook/webapi/file/upload"
						method="post" enctype="multipart/form-data">
						<p id="uploadImage">
							Select a file : <input type="file" name="file" size="45" class="btn btn-success"/>
						</p>
						<input type="text" name="Id" id="profilePhotoId" value=""
							style="display:none;"> <input type="submit"
							value="Upload It" class="btn btn-warning" />

					</form>
                    </div>
				    <div class="col-md-4">
				        <img src="a.jpg" id="modalProfileImg" style="width:100%;height:10em;" onError="doSomething();" />
				    </div>
				</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

<script>
	/*function load_home() {
	 document.getElementById("section1").innerHTML='<object type="text/html" data="home.html" style="width:100%; height: 100%;" ></object>';
	}*/
	//var friends=document.getElementById("section2");
	//var photos=document.getElementById("section3");
	var profileImgTemp="a.jpg";
	window.onload = function() {
		//when the document is finished loading, replace everything
		//between the <a ...> </a> tags with the value of splitText
		document.getElementById("profilePhotoId").value = sessionStorage.id;
		//document.getElementById("profilePhotoImg").src="users/"+sessionStorage.id+"/profile.jpg";
	}
	
	function doSomething() {
	    document.getElementById('modalProfileImg').src=profileImgTemp;
	} 
	//-----------------------------------------------------------------//
	//------------------------------------------------------------//
	$('#myModal2')
			.on(
					'shown.bs.modal',
					function(e) {
						document.getElementById("profilePhotoId").value = sessionStorage.id;
					})
	//------------------------------------------------------------//
	//-----------------------------------------------------------------//
	$(".btn").mouseup(function() {
		$(this).blur();
	})
	//-----------------------------------------------------------//
	$.ajax({
		type : "post",
		// make sure you respect the same origin policy with this url:
		// http://en.wikipedia.org/wiki/Same_origin_policy
		//dataType: "text",
		url : "/facebook/webapi/profile/"
				+ sessionStorage.id,

		success : function(msg) {
			console.log(msg);
			document.getElementById("profilePhotoImg").src = msg.profileImage;
		}
	});
	//-----------------------------------/
	var modalform2 = $('#myModal2Form');
	modalform2.submit(function() {
		var fd = new FormData($('#myModal2Form')[0]);
	    console.info(fd);
		$.ajax({
			type : modalform2.attr('method'),
			url : modalform2.attr('action'),
			data : fd,
			enctype: 'multipart/form-data',
	        processData: false,  // Important!
	        contentType: false,
	        cache: false,
			success : function(data) {
				if(data){
					profileImgTemp=data;
					document.getElementById('modalProfileImg').src=profileImgTemp;
					//setTimeout(location.reload.bind(location),8000);
				}
				else{
					alert("Try Again");
				}
			}
		});

		return false;
	});
</script>